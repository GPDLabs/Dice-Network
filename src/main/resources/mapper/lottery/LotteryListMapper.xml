<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.gpd.dicenetwork.lottery.mapper.LotteryListMapper">

    <resultMap id="LotteryEntryResultMap" type="org.gpd.dicenetwork.lottery.entity.LotteryListEntity">
        <id column="id" property="id" />
        <result column="wallet_addr" property="walletAddr" />
        <result column="random_hash" property="randomHash" />
        <result column="lottery_time" property="lotteryTime" />
        <result column="is_winner" property="isWinner" />
    </resultMap>
    <!-- 插入单个记录 -->
    <insert id="insert" parameterType="org.gpd.dicenetwork.lottery.entity.LotteryListEntity">
        INSERT INTO lottery_list (wallet_addr, random_hash, lottery_time, is_winner)
        VALUES (#{walletAddr}, #{randomHash}, #{lotteryTime}, #{isWinner})
    </insert>

    <!-- 批量插入记录 -->
    <insert id="insertBatch" parameterType="java.util.List">
        INSERT INTO lottery_list (wallet_addr, random_hash, lottery_time, is_winner)
        VALUES
        <foreach collection="lotteries" item="lottery" separator=",">
            (#{lottery.walletAddr}, #{lottery.randomHash}, #{lottery.lotteryTime}, #{lottery.isWinner})
        </foreach>
    </insert>

    <!-- 更新记录 -->
    <update id="updateById" parameterType="org.gpd.dicenetwork.lottery.entity.LotteryListEntity">
        UPDATE lottery_list
        SET wallet_addr = #{walletAddr},
            random_hash = #{randomHash},
            lottery_time = #{lotteryTime},
            is_winner = #{isWinner}
        WHERE id = #{id}
    </update>

    <!-- 删除记录 -->
    <delete id="deleteById" parameterType="int">
        DELETE FROM lottery_list WHERE id = #{id}
    </delete>

    <!-- 查询所有记录 -->
    <select id="selectList" resultType="org.gpd.dicenetwork.lottery.entity.LotteryListEntity">
        SELECT * FROM lottery_list
    </select>

    <!-- 根据ID查询记录 -->
    <select id="selectById" parameterType="int" resultType="org.gpd.dicenetwork.lottery.entity.LotteryListEntity">
        SELECT * FROM lottery_list WHERE id = #{id}
    </select>

    <select id="selectByLotteryTime" resultMap="LotteryEntryResultMap">
        SELECT id, wallet_addr, random_hash, lottery_time, is_winner
        FROM lottery_list
        WHERE lottery_time = #{lotteryTime, jdbcType=TIMESTAMP}
    </select>

</mapper>
